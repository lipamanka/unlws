<!DOCTYPE>

<html>

  <head>
    <title>cytoscape-edgehandles.js compound snapping demo</title>

    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">

    <script src="./javascripts/lodash.js"></script>
    <!-- <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script> -->

    <!-- for testing with local version of cytoscape.js -->
    <script src="javascripts/cytoscape.umd.js"></script>
    <!-- <script type="module">
      import lodash from "./javascripts/lodash.js";
      import cytoscape from "./javascripts/cytoscape.esm.js";
    </script> -->

    <script src="./javascripts/cytoscape-edgehandles.js"></script>

    <style>
      body {
        font-family: helvetica neue, helvetica, liberation sans, arial, sans-serif;
        font-size: 14px;
      }

      #cy {
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        right: 0;
        z-index: 999;
      }

      h1 {
        opacity: 0.5;
        font-size: 1em;
        font-weight: bold;
      }

      #buttons {
        position: absolute;
        right: 0;
        bottom: 0;
        z-index: 99999;
      }
    </style>

    <script>
      document.addEventListener('DOMContentLoaded', function(){

        var cy = window.cy = cytoscape({
          container: document.getElementById('cy'),

          layout: {
            name: 'preset'
          },

          
          style: [
            {
              selector: 'node',
              style: {
                'width': '1px',
                'height': '1px',
                'border-opacity': 0.1
              }
            },
            
            {
              selector: 'node:childless',
              style: {
                'background-color': 'red'
              }
            },
            
            {
              selector: 'node:parent',
              style: {
                'background-opacity': 0
              }
            },
            
            {
              selector: 'node[name]',
              style: {
                'content': 'data(name)'
              }
            },

            {
              selector: 'edge',
              style: {
                'curve-style': 'straight',
                'target-arrow-shape': 'none',
                'width': '1px'
              }
            },
            {
              selector: 'edge.bez',
              style: {
                'curve-style': 'unbundled-bezier',
                "control-point-step-size": 96,
                'target-arrow-shape': 'none',
                'width': '1px'
              }
            },
            
            // {
            //   "selector": "edge.bezier",
            //   "style": {
            //     "curve-style": "bezier",
            //     "control-point-step-size": 40
            //   }
            // }, {
            //   "selector": "edge.unbundled-bezier",
            //   "style": {
            //     "curve-style": "unbundled-bezier",
            //     "control-point-distances": 120,
            //     "control-point-weights": 0.1
            //   }
            // }, {
            //   "selector": "edge.multi-unbundled-bezier",
            //   "style": {
            //     "curve-style": "unbundled-bezier",
            //     "control-point-distances": [40, -40],
            //     "control-point-weights": [0.250, 0.75]
            //   }
            // }, {
            //   "selector": "edge.haystack",
            //   "style": {
            //     "curve-style": "haystack",
            //     "haystack-radius": 0.5
            //   }
            // }, {
            //   "selector": "edge.segments",
            //   "style": {
            //     "curve-style": "segments",
            //     "segment-distances": [ 40, -40 ],
            //     "segment-weights": [0.250 , 0.75]
            //   }
            // }, {
            //   "selector": "edge.taxi",
            //   "style": {
            //     "curve-style": "taxi",
            //     "taxi-direction": "downward",
            //     "taxi-turn": 20,
            //     "taxi-turn-min-distance": 5
            //   }
            // },

            // some style for the extension
            {
              selector: '.eh-handle',
              style: {
                'background-color': 'red',
                'width': 12,
                'height': 12,
                'shape': 'ellipse',
                'overlay-opacity': 0,
                'border-width': 12, // makes the handle easier to hit
                'border-opacity': 0
              }
            },

            {
              selector: '.eh-hover',
              style: {
                'background-color': 'red'
              }
            },

            {
              selector: '.eh-source',
              style: {
                'border-width': 2,
                'border-color': 'red'
              }
            },

            {
              selector: '.eh-target',
              style: {
                'border-width': 2,
                'border-color': 'red'
              }
            },

            {
              selector: '.eh-preview, .eh-ghost-edge',
              style: {
                'background-color': 'red',
                'line-color': 'red',
                'target-arrow-color': 'red',
                'source-arrow-color': 'red'
              }
            },
            {
              selector: '.eh-ghost-edge.eh-preview-active',
              style: {
                'opacity': 0
              }
            }
          ],

          elements: [
            {
              "data": {
                "id": "1sg"
              },
              "position": {
                "x": 0.0,
                "y": 0.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "1sg:n0",
                "parent": "1sg"
              },
              "position": {
                "x": 0.0,
                "y": 0.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "1sg:n1",
                "parent": "1sg"
              },
              "position": {
                "x": -64.0,
                "y": 0.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "1sg:n2",
                "parent": "1sg"
              },
              "position": {
                "x": 0.0,
                "y": 64.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "1sg:n3",
                "parent": "1sg"
              },
              "position": {
                "x": 0.0,
                "y": -32.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "1sg:n4",
                "parent": "1sg"
              },
              "position": {
                "x": 32.0,
                "y": 0.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "stone"
              },
              "position": {
                "x": 224.0,
                "y": 0.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "stone:n0",
                "parent": "stone"
              },
              "position": {
                "x": 192.0,
                "y": 32.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "stone:n1",
                "parent": "stone"
              },
              "position": {
                "x": 256.0,
                "y": 32.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "stone:n2",
                "parent": "stone"
              },
              "position": {
                "x": 256.0,
                "y": -32.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "stone:n3",
                "parent": "stone"
              },
              "position": {
                "x": 192.0,
                "y": -32.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "stone:n4",
                "parent": "stone"
              },
              "position": {
                "x": 224.0,
                "y": 0.0
              },
              "group": "nodes"
            },
            {
              "data": {
                "id": "e0",
                "source": "1sg:n0",
                "target": "1sg:n1"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e1",
                "source": "1sg:n1",
                "target": "1sg:n2"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e2",
                "source": "1sg:n2",
                "target": "1sg:n0"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e3",
                "source": "1sg:n0",
                "target": "1sg:n3"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e4",
                "source": "1sg:n4",
                "target": "1sg:n0"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "elong",
                "source": "1sg:n4",
                "target": "stone:n0"
              },
              "style": {
                "line-color": "green",
                "control-point-distance": -16
              },
              "group": "edges",
              "classes": "bez"
            },
            {
              "data": {
                "id": "e5",
                "source": "stone:n0",
                "target": "stone:n1"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e6",
                "source": "stone:n1",
                "target": "stone:n2"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e7",
                "source": "stone:n2",
                "target": "stone:n3"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e8",
                "source": "stone:n3",
                "target": "stone:n4"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e9",
                "source": "stone:n4",
                "target": "stone:n1"
              },
              "group": "edges"
            },
            {
              "data": {
                "id": "e10",
                "source": "stone:n0",
                "target": "stone:n4"
              },
              "group": "edges"
            }
          ]
        });

        // var eh = cy.edgehandles({
        //   noEdgeEventsInDraw: true,
        //   snap: true
        // });
        //
        // document.querySelector('#draw-on').addEventListener('click', function() {
        //   eh.enableDrawMode();
        // });
        //
        // document.querySelector('#draw-off').addEventListener('click', function() {
        //   eh.disableDrawMode();
        // });
        //
        // document.querySelector('#start').addEventListener('click', function() {
        //   eh.start( cy.$('node:selected') );
        // });

      });
    </script>
  </head>

  <body>
    <h1>cytoscape-edgehandles compound snapping demo</h1>

    <div id="cy"></div>

    <!-- <div id="buttons">
      <button id="start">Start on selected</button>
      <button id="draw-on">Draw mode on</button>
      <button id="draw-off">Draw mode off</button>
    </div> -->

  </body>

</html>